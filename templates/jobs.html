{% extends 'testuserAuth.html' %} {% block content %}

<div
  id="jobs-container"
  class="p-4 border-2 border-gray-200 border-dashed rounded-lg dark:border-gray-700 mt-14 bg-gray-50/30"
>
  <div class="flex items-center justify-between mb-8">
    <div>
      <h2 class="text-3xl font-extrabold text-gray-900">
        Suitable Job Matchings
      </h2>
      <p class="text-gray-500 mt-1">
        AI-powered job recommendations based on your profile.
      </p>
    </div>
    <span
      class="bg-blue-100 text-blue-800 text-xs font-semibold px-3 py-1 rounded-full uppercase"
    >
      {{ vacancies|length }} Openings
    </span>
  </div>

  <div class="grid grid-cols-1 md:grid-cols-2 xl:grid-cols-3 gap-6">
    {% for job in vacancies %}
    <div
      class="bg-white rounded-2xl shadow-sm border border-gray-100 p-6 hover:shadow-md transition-all duration-300 flex flex-col justify-between"
    >
      <div>
        <div class="flex justify-between items-start mb-4">
          <div class="p-3 bg-blue-50 rounded-xl">
            <svg
              class="w-6 h-6 text-blue-600"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M21 13.255A23.931 23.931 0 0112 15c-3.183 0-6.22-.62-9-1.745M16 6V4a2 2 0 00-2-2h-4a2 2 0 00-2 2v2m4 6h.01M5 20h14a2 2 0 002-2V8a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"
              ></path>
            </svg>
          </div>
          <span
            class="text-[10px] font-bold py-1 px-2 rounded {% if job.matched_template == 'technical' %} bg-blue-100 text-blue-700 {% elif job.matched_template == 'creative' %} bg-purple-100 text-purple-700 {% elif job.matched_template == 'professional' %} bg-green-100 text-green-700 {% else %} bg-gray-100 text-gray-700 {% endif %} uppercase"
          >
            {{ job.matched_template }}
          </span>
        </div>

        <h3 class="text-xl font-bold text-gray-800 mb-1">{{ job.title }}</h3>
        <p class="text-blue-600 font-medium text-sm mb-4">{{ job.company }}</p>

        <div class="mb-4">
          <p class="text-gray-500 text-sm line-clamp-3">
            {{ job.description }}
          </p>
        </div>

        <div class="flex flex-wrap gap-2 mb-6">
          {% for skill in job.skills_list %}
          <span
            class="text-[11px] bg-gray-100 text-gray-600 px-2 py-1 rounded-md border border-gray-200"
          >
            {{ skill }}
          </span>
          {% endfor %}
        </div>
      </div>

      <div
        class="pt-4 border-t border-gray-50 flex items-center justify-between"
      >
        <a
          href="{% url 'apply_job' job.id %}"
          class="apply-btn text-sm font-bold text-blue-600 hover:text-blue-700 inline-flex items-center"
        >
          Apply Now
          <svg
            class="w-4 h-4 ml-1"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path d="M14 5l7 7m0 0l-7 7m7-7H3"></path>
          </svg>
        </a>
        <button class="text-gray-400 hover:text-red-500 transition-colors">
          <svg
            class="w-5 h-5"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
          >
            <path
              d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z"
            ></path>
          </svg>
        </button>
      </div>
    </div>
    {% empty %}
    <div class="col-span-full py-20 text-center">
      <img
        src="/static/dashboardWc/no-jobs.png"
        alt="No Jobs"
        class="mx-auto w-48 mb-4 opacity-50"
      />
      <h3 class="text-lg font-medium text-gray-600">
        No jobs found matching your criteria.
      </h3>
      <p class="text-gray-400">Try updating your skills in your profile.</p>
    </div>
    {% endfor %}
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
  document.querySelectorAll(".apply-btn").forEach((button) => {
    button.addEventListener("click", function (e) {
      e.preventDefault();
      const applyUrl = this.getAttribute("href");

      Swal.fire({
        title: "Apply for this position?",
        text: "Your current profile and resume score will be shared with the recruiter.",
        icon: "question",
        showCancelButton: true,
        confirmButtonColor: "#2563eb",
        cancelButtonColor: "#6b7280",
        confirmButtonText: "Yes, Apply Now!",
      }).then((result) => {
        if (result.isConfirmed) {
          window.location.href = applyUrl;
        }
      });
    });
  });
</script>

{% endblock %}
